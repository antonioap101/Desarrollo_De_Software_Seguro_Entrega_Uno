// buffer_overflow_gets.c
// Ejemplo de vulnerabilidad: Buffer Overflow con gets()

#include <stdio.h>

void vulnerable_function() {
    char buffer[16];  // Buffer pequeño a propósito
    printf("Dirección del buffer: %p\n", (void*)&buffer);

    printf("Introduce un texto: ");
    gets(buffer);  // Función insegura, no valida el tamaño de la entrada

    printf("Contenido del buffer: %s\n", buffer);
}

void malicious_function() {
    printf("¡Función maliciosa ejecutada!\n");
}

int main() {
    printf("Llamando a la función vulnerable...\n");
    vulnerable_function();

    printf("Ejecución finalizada.\n");
    return 0;
}
